ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"spi-board.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.SpiDeInit,"ax",%progbits
  18              		.align	1
  19              		.global	SpiDeInit
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	SpiDeInit:
  27              	.LVL0:
  28              	.LFB136:
  29              		.file 1 "Core/Src/boards/NucleoL476/spi-board.c"
   1:Core/Src/boards/NucleoL476/spi-board.c **** /*
   2:Core/Src/boards/NucleoL476/spi-board.c ****   ______                              _
   3:Core/Src/boards/NucleoL476/spi-board.c ****  / _____)             _              | |
   4:Core/Src/boards/NucleoL476/spi-board.c **** ( (____  _____ ____ _| |_ _____  ____| |__
   5:Core/Src/boards/NucleoL476/spi-board.c ****  \____ \| ___ |    (_   _) ___ |/ ___)  _ \
   6:Core/Src/boards/NucleoL476/spi-board.c ****  _____) ) ____| | | || |_| ____( (___| | | |
   7:Core/Src/boards/NucleoL476/spi-board.c **** (______/|_____)_|_|_| \__)_____)\____)_| |_|
   8:Core/Src/boards/NucleoL476/spi-board.c ****     (C)2013 Semtech
   9:Core/Src/boards/NucleoL476/spi-board.c **** 
  10:Core/Src/boards/NucleoL476/spi-board.c **** Description: Bleeper board SPI driver implementation
  11:Core/Src/boards/NucleoL476/spi-board.c **** 
  12:Core/Src/boards/NucleoL476/spi-board.c **** License: Revised BSD License, see LICENSE.TXT file include in the project
  13:Core/Src/boards/NucleoL476/spi-board.c **** 
  14:Core/Src/boards/NucleoL476/spi-board.c **** Maintainer: Miguel Luis and Gregory Cristian
  15:Core/Src/boards/NucleoL476/spi-board.c **** */
  16:Core/Src/boards/NucleoL476/spi-board.c **** #include "board.h"
  17:Core/Src/boards/NucleoL476/spi-board.c **** #include "spi-board.h"
  18:Core/Src/boards/NucleoL476/spi-board.c **** #include "stm32l4xx_hal_spi.h"
  19:Core/Src/boards/NucleoL476/spi-board.c **** 
  20:Core/Src/boards/NucleoL476/spi-board.c **** 
  21:Core/Src/boards/NucleoL476/spi-board.c **** #define SPI_SIZE_8BIT   0
  22:Core/Src/boards/NucleoL476/spi-board.c **** 
  23:Core/Src/boards/NucleoL476/spi-board.c **** /*!
  24:Core/Src/boards/NucleoL476/spi-board.c ****  * MCU SPI peripherals enumeration
  25:Core/Src/boards/NucleoL476/spi-board.c ****  */
  26:Core/Src/boards/NucleoL476/spi-board.c **** typedef enum
  27:Core/Src/boards/NucleoL476/spi-board.c **** {
  28:Core/Src/boards/NucleoL476/spi-board.c ****     SPI_1 = ( uint32_t )SPI1_BASE,
  29:Core/Src/boards/NucleoL476/spi-board.c ****     SPI_2 = ( uint32_t )SPI2_BASE,
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 2


  30:Core/Src/boards/NucleoL476/spi-board.c **** }SPIName;
  31:Core/Src/boards/NucleoL476/spi-board.c **** 
  32:Core/Src/boards/NucleoL476/spi-board.c **** void SpiInit( Spi_t *obj, PinNames mosi, PinNames miso, PinNames sclk, PinNames nss )
  33:Core/Src/boards/NucleoL476/spi-board.c **** {
  34:Core/Src/boards/NucleoL476/spi-board.c ****     BoardDisableIrq( );
  35:Core/Src/boards/NucleoL476/spi-board.c **** 
  36:Core/Src/boards/NucleoL476/spi-board.c ****     // Choose SPI interface according to the given pins
  37:Core/Src/boards/NucleoL476/spi-board.c ****     if( ( mosi == PB_5 ) || ( mosi == PA_7 ) )
  38:Core/Src/boards/NucleoL476/spi-board.c ****     {
  39:Core/Src/boards/NucleoL476/spi-board.c ****         __HAL_RCC_SPI1_FORCE_RESET( );
  40:Core/Src/boards/NucleoL476/spi-board.c ****         __HAL_RCC_SPI1_RELEASE_RESET( );
  41:Core/Src/boards/NucleoL476/spi-board.c **** 
  42:Core/Src/boards/NucleoL476/spi-board.c ****         __HAL_RCC_SPI1_CLK_ENABLE( );
  43:Core/Src/boards/NucleoL476/spi-board.c **** 
  44:Core/Src/boards/NucleoL476/spi-board.c ****         obj->Spi.Instance = ( SPI_TypeDef* )SPI1_BASE;
  45:Core/Src/boards/NucleoL476/spi-board.c **** 
  46:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Mosi, mosi, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI1 
  47:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Miso, miso, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI1 
  48:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Sclk, sclk, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI1 
  49:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Nss, nss, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_UP, GPIO_AF5_SPI1 );
  50:Core/Src/boards/NucleoL476/spi-board.c **** 
  51:Core/Src/boards/NucleoL476/spi-board.c ****         if( nss == NC )
  52:Core/Src/boards/NucleoL476/spi-board.c ****         {
  53:Core/Src/boards/NucleoL476/spi-board.c ****             obj->Spi.Init.NSS = SPI_NSS_SOFT;
  54:Core/Src/boards/NucleoL476/spi-board.c ****             SpiFormat( obj, SPI_SIZE_8BIT, SPI_POLARITY_LOW, SPI_PHASE_1EDGE, 0 );
  55:Core/Src/boards/NucleoL476/spi-board.c ****         }
  56:Core/Src/boards/NucleoL476/spi-board.c ****         else
  57:Core/Src/boards/NucleoL476/spi-board.c ****         {
  58:Core/Src/boards/NucleoL476/spi-board.c ****             SpiFormat( obj, SPI_SIZE_8BIT, SPI_POLARITY_LOW, SPI_PHASE_1EDGE, 1 );
  59:Core/Src/boards/NucleoL476/spi-board.c ****         }
  60:Core/Src/boards/NucleoL476/spi-board.c ****     }
  61:Core/Src/boards/NucleoL476/spi-board.c ****     else if( mosi == PB_15 )
  62:Core/Src/boards/NucleoL476/spi-board.c ****     {
  63:Core/Src/boards/NucleoL476/spi-board.c ****         __HAL_RCC_SPI2_FORCE_RESET( );
  64:Core/Src/boards/NucleoL476/spi-board.c ****         __HAL_RCC_SPI2_RELEASE_RESET( );
  65:Core/Src/boards/NucleoL476/spi-board.c **** 
  66:Core/Src/boards/NucleoL476/spi-board.c ****         __HAL_RCC_SPI2_CLK_ENABLE( );
  67:Core/Src/boards/NucleoL476/spi-board.c **** 
  68:Core/Src/boards/NucleoL476/spi-board.c ****         obj->Spi.Instance = ( SPI_TypeDef* )SPI2_BASE;
  69:Core/Src/boards/NucleoL476/spi-board.c **** 
  70:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Mosi, mosi, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI2 
  71:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Miso, miso, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI2 
  72:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Sclk, sclk, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI2 
  73:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Nss, nss, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_UP, GPIO_AF5_SPI2 );
  74:Core/Src/boards/NucleoL476/spi-board.c **** 
  75:Core/Src/boards/NucleoL476/spi-board.c ****         if( nss == NC )
  76:Core/Src/boards/NucleoL476/spi-board.c ****         {
  77:Core/Src/boards/NucleoL476/spi-board.c ****             obj->Spi.Init.NSS = SPI_NSS_SOFT;
  78:Core/Src/boards/NucleoL476/spi-board.c ****             SpiFormat( obj, SPI_SIZE_8BIT, SPI_POLARITY_LOW, SPI_PHASE_1EDGE, 0 );
  79:Core/Src/boards/NucleoL476/spi-board.c ****         }
  80:Core/Src/boards/NucleoL476/spi-board.c ****         else
  81:Core/Src/boards/NucleoL476/spi-board.c ****         {
  82:Core/Src/boards/NucleoL476/spi-board.c ****             SpiFormat( obj, SPI_SIZE_8BIT, SPI_POLARITY_LOW, SPI_PHASE_1EDGE, 1 );
  83:Core/Src/boards/NucleoL476/spi-board.c ****         }
  84:Core/Src/boards/NucleoL476/spi-board.c ****     }
  85:Core/Src/boards/NucleoL476/spi-board.c ****     SpiFrequency( obj, 16000000 );
  86:Core/Src/boards/NucleoL476/spi-board.c **** 
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 3


  87:Core/Src/boards/NucleoL476/spi-board.c ****     HAL_SPI_Init( &obj->Spi );
  88:Core/Src/boards/NucleoL476/spi-board.c **** 
  89:Core/Src/boards/NucleoL476/spi-board.c ****     BoardEnableIrq( );
  90:Core/Src/boards/NucleoL476/spi-board.c **** }
  91:Core/Src/boards/NucleoL476/spi-board.c **** 
  92:Core/Src/boards/NucleoL476/spi-board.c **** void SpiDeInit( Spi_t *obj )
  93:Core/Src/boards/NucleoL476/spi-board.c **** {
  30              		.loc 1 93 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 93 1 is_stmt 0 view .LVU1
  35 0000 30B5     		push	{r4, r5, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 12
  38              		.cfi_offset 4, -12
  39              		.cfi_offset 5, -8
  40              		.cfi_offset 14, -4
  41 0002 83B0     		sub	sp, sp, #12
  42              	.LCFI1:
  43              		.cfi_def_cfa_offset 24
  44 0004 0446     		mov	r4, r0
  94:Core/Src/boards/NucleoL476/spi-board.c ****     HAL_SPI_DeInit( &obj->Spi );
  45              		.loc 1 94 5 is_stmt 1 view .LVU2
  46 0006 FFF7FEFF 		bl	HAL_SPI_DeInit
  47              	.LVL1:
  95:Core/Src/boards/NucleoL476/spi-board.c **** 
  96:Core/Src/boards/NucleoL476/spi-board.c ****     GpioInit( &obj->Mosi, obj->Mosi.pin, PIN_ANALOGIC, PIN_PUSH_PULL, PIN_NO_PULL, 0 );
  48              		.loc 1 96 5 view .LVU3
  49 000a 2046     		mov	r0, r4
  50 000c 0025     		movs	r5, #0
  51 000e 0195     		str	r5, [sp, #4]
  52 0010 0095     		str	r5, [sp]
  53 0012 2B46     		mov	r3, r5
  54 0014 0322     		movs	r2, #3
  55 0016 10F9641F 		ldrsb	r1, [r0, #100]!
  56 001a FFF7FEFF 		bl	GpioInit
  57              	.LVL2:
  97:Core/Src/boards/NucleoL476/spi-board.c ****     GpioInit( &obj->Miso, obj->Miso.pin, PIN_ANALOGIC, PIN_PUSH_PULL, PIN_NO_PULL, 0 );
  58              		.loc 1 97 5 view .LVU4
  59 001e 2046     		mov	r0, r4
  60 0020 0195     		str	r5, [sp, #4]
  61 0022 0095     		str	r5, [sp]
  62 0024 2B46     		mov	r3, r5
  63 0026 0322     		movs	r2, #3
  64 0028 10F9701F 		ldrsb	r1, [r0, #112]!
  65 002c FFF7FEFF 		bl	GpioInit
  66              	.LVL3:
  98:Core/Src/boards/NucleoL476/spi-board.c ****     GpioInit( &obj->Sclk, obj->Sclk.pin, PIN_ANALOGIC, PIN_PUSH_PULL, PIN_NO_PULL, 0 );
  67              		.loc 1 98 5 view .LVU5
  68 0030 2046     		mov	r0, r4
  69 0032 0195     		str	r5, [sp, #4]
  70 0034 0095     		str	r5, [sp]
  71 0036 2B46     		mov	r3, r5
  72 0038 0322     		movs	r2, #3
  73 003a 10F97C1F 		ldrsb	r1, [r0, #124]!
  74 003e FFF7FEFF 		bl	GpioInit
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 4


  75              	.LVL4:
  99:Core/Src/boards/NucleoL476/spi-board.c ****     GpioInit( &obj->Nss, obj->Nss.pin, PIN_ANALOGIC, PIN_PUSH_PULL, PIN_PULL_UP, 1 );
  76              		.loc 1 99 5 view .LVU6
  77 0042 2046     		mov	r0, r4
  78 0044 0123     		movs	r3, #1
  79 0046 0193     		str	r3, [sp, #4]
  80 0048 0093     		str	r3, [sp]
  81 004a 2B46     		mov	r3, r5
  82 004c 0322     		movs	r2, #3
  83 004e 10F9881F 		ldrsb	r1, [r0, #136]!
  84 0052 FFF7FEFF 		bl	GpioInit
  85              	.LVL5:
 100:Core/Src/boards/NucleoL476/spi-board.c **** }
  86              		.loc 1 100 1 is_stmt 0 view .LVU7
  87 0056 03B0     		add	sp, sp, #12
  88              	.LCFI2:
  89              		.cfi_def_cfa_offset 12
  90              		@ sp needed
  91 0058 30BD     		pop	{r4, r5, pc}
  92              		.loc 1 100 1 view .LVU8
  93              		.cfi_endproc
  94              	.LFE136:
  96              		.section	.text.SpiFormat,"ax",%progbits
  97              		.align	1
  98              		.global	SpiFormat
  99              		.syntax unified
 100              		.thumb
 101              		.thumb_func
 102              		.fpu fpv4-sp-d16
 104              	SpiFormat:
 105              	.LVL6:
 106              	.LFB137:
 101:Core/Src/boards/NucleoL476/spi-board.c **** 
 102:Core/Src/boards/NucleoL476/spi-board.c **** void SpiFormat( Spi_t *obj, int8_t bits, int8_t cpol, int8_t cpha, int8_t slave )
 103:Core/Src/boards/NucleoL476/spi-board.c **** {
 107              		.loc 1 103 1 is_stmt 1 view -0
 108              		.cfi_startproc
 109              		@ args = 4, pretend = 0, frame = 0
 110              		@ frame_needed = 0, uses_anonymous_args = 0
 111              		@ link register save eliminated.
 112              		.loc 1 103 1 is_stmt 0 view .LVU10
 113 0000 30B4     		push	{r4, r5}
 114              	.LCFI3:
 115              		.cfi_def_cfa_offset 8
 116              		.cfi_offset 4, -8
 117              		.cfi_offset 5, -4
 118 0002 9DF90840 		ldrsb	r4, [sp, #8]
 104:Core/Src/boards/NucleoL476/spi-board.c ****     obj->Spi.Init.Direction = SPI_DIRECTION_2LINES;
 119              		.loc 1 104 5 is_stmt 1 view .LVU11
 120              		.loc 1 104 29 is_stmt 0 view .LVU12
 121 0006 0025     		movs	r5, #0
 122 0008 8560     		str	r5, [r0, #8]
 105:Core/Src/boards/NucleoL476/spi-board.c ****     if( bits == SPI_SIZE_8BIT )
 123              		.loc 1 105 5 is_stmt 1 view .LVU13
 124              		.loc 1 105 7 is_stmt 0 view .LVU14
 125 000a 81B9     		cbnz	r1, .L4
 106:Core/Src/boards/NucleoL476/spi-board.c ****     {
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 5


 107:Core/Src/boards/NucleoL476/spi-board.c ****         obj->Spi.Init.DataSize = SPI_DATASIZE_8BIT;
 126              		.loc 1 107 9 is_stmt 1 view .LVU15
 127              		.loc 1 107 32 is_stmt 0 view .LVU16
 128 000c 4FF4E061 		mov	r1, #1792
 129              	.LVL7:
 130              		.loc 1 107 32 view .LVU17
 131 0010 C160     		str	r1, [r0, #12]
 132              	.L5:
 108:Core/Src/boards/NucleoL476/spi-board.c ****     }
 109:Core/Src/boards/NucleoL476/spi-board.c ****     else
 110:Core/Src/boards/NucleoL476/spi-board.c ****     {
 111:Core/Src/boards/NucleoL476/spi-board.c ****         obj->Spi.Init.DataSize = SPI_DATASIZE_16BIT;
 112:Core/Src/boards/NucleoL476/spi-board.c ****     }
 113:Core/Src/boards/NucleoL476/spi-board.c ****     obj->Spi.Init.CLKPolarity = cpol;
 133              		.loc 1 113 5 is_stmt 1 view .LVU18
 134              		.loc 1 113 31 is_stmt 0 view .LVU19
 135 0012 0261     		str	r2, [r0, #16]
 114:Core/Src/boards/NucleoL476/spi-board.c ****     obj->Spi.Init.CLKPhase = cpha;
 136              		.loc 1 114 5 is_stmt 1 view .LVU20
 137              		.loc 1 114 28 is_stmt 0 view .LVU21
 138 0014 4361     		str	r3, [r0, #20]
 115:Core/Src/boards/NucleoL476/spi-board.c ****     obj->Spi.Init.FirstBit = SPI_FIRSTBIT_MSB;
 139              		.loc 1 115 5 is_stmt 1 view .LVU22
 140              		.loc 1 115 28 is_stmt 0 view .LVU23
 141 0016 0023     		movs	r3, #0
 142              	.LVL8:
 143              		.loc 1 115 28 view .LVU24
 144 0018 0362     		str	r3, [r0, #32]
 116:Core/Src/boards/NucleoL476/spi-board.c ****     obj->Spi.Init.TIMode = SPI_TIMODE_DISABLE;
 145              		.loc 1 116 5 is_stmt 1 view .LVU25
 146              		.loc 1 116 26 is_stmt 0 view .LVU26
 147 001a 4362     		str	r3, [r0, #36]
 117:Core/Src/boards/NucleoL476/spi-board.c ****     obj->Spi.Init.CRCCalculation = SPI_CRCCALCULATION_DISABLE;
 148              		.loc 1 117 5 is_stmt 1 view .LVU27
 149              		.loc 1 117 34 is_stmt 0 view .LVU28
 150 001c 8362     		str	r3, [r0, #40]
 118:Core/Src/boards/NucleoL476/spi-board.c ****     obj->Spi.Init.CRCPolynomial = 7;
 151              		.loc 1 118 5 is_stmt 1 view .LVU29
 152              		.loc 1 118 33 is_stmt 0 view .LVU30
 153 001e 0723     		movs	r3, #7
 154 0020 C362     		str	r3, [r0, #44]
 119:Core/Src/boards/NucleoL476/spi-board.c **** 
 120:Core/Src/boards/NucleoL476/spi-board.c ****     if( slave == 0 )
 155              		.loc 1 120 5 is_stmt 1 view .LVU31
 156              		.loc 1 120 7 is_stmt 0 view .LVU32
 157 0022 44B9     		cbnz	r4, .L6
 121:Core/Src/boards/NucleoL476/spi-board.c ****     {
 122:Core/Src/boards/NucleoL476/spi-board.c ****         obj->Spi.Init.Mode = SPI_MODE_MASTER;
 158              		.loc 1 122 9 is_stmt 1 view .LVU33
 159              		.loc 1 122 28 is_stmt 0 view .LVU34
 160 0024 4FF48273 		mov	r3, #260
 161 0028 4360     		str	r3, [r0, #4]
 162              	.L3:
 123:Core/Src/boards/NucleoL476/spi-board.c ****     }
 124:Core/Src/boards/NucleoL476/spi-board.c ****     else
 125:Core/Src/boards/NucleoL476/spi-board.c ****     {
 126:Core/Src/boards/NucleoL476/spi-board.c ****         obj->Spi.Init.Mode = SPI_MODE_SLAVE;
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 6


 127:Core/Src/boards/NucleoL476/spi-board.c ****     }
 128:Core/Src/boards/NucleoL476/spi-board.c **** }
 163              		.loc 1 128 1 view .LVU35
 164 002a 30BC     		pop	{r4, r5}
 165              	.LCFI4:
 166              		.cfi_remember_state
 167              		.cfi_restore 5
 168              		.cfi_restore 4
 169              		.cfi_def_cfa_offset 0
 170              	.LVL9:
 171              		.loc 1 128 1 view .LVU36
 172 002c 7047     		bx	lr
 173              	.LVL10:
 174              	.L4:
 175              	.LCFI5:
 176              		.cfi_restore_state
 111:Core/Src/boards/NucleoL476/spi-board.c ****     }
 177              		.loc 1 111 9 is_stmt 1 view .LVU37
 111:Core/Src/boards/NucleoL476/spi-board.c ****     }
 178              		.loc 1 111 32 is_stmt 0 view .LVU38
 179 002e 4FF47061 		mov	r1, #3840
 180              	.LVL11:
 111:Core/Src/boards/NucleoL476/spi-board.c ****     }
 181              		.loc 1 111 32 view .LVU39
 182 0032 C160     		str	r1, [r0, #12]
 183 0034 EDE7     		b	.L5
 184              	.LVL12:
 185              	.L6:
 126:Core/Src/boards/NucleoL476/spi-board.c ****     }
 186              		.loc 1 126 9 is_stmt 1 view .LVU40
 126:Core/Src/boards/NucleoL476/spi-board.c ****     }
 187              		.loc 1 126 28 is_stmt 0 view .LVU41
 188 0036 0023     		movs	r3, #0
 189 0038 4360     		str	r3, [r0, #4]
 190              		.loc 1 128 1 view .LVU42
 191 003a F6E7     		b	.L3
 192              		.cfi_endproc
 193              	.LFE137:
 195              		.section	.text.SpiFrequency,"ax",%progbits
 196              		.align	1
 197              		.global	SpiFrequency
 198              		.syntax unified
 199              		.thumb
 200              		.thumb_func
 201              		.fpu fpv4-sp-d16
 203              	SpiFrequency:
 204              	.LVL13:
 205              	.LFB138:
 129:Core/Src/boards/NucleoL476/spi-board.c **** 
 130:Core/Src/boards/NucleoL476/spi-board.c **** void SpiFrequency( Spi_t *obj, uint32_t hz )
 131:Core/Src/boards/NucleoL476/spi-board.c **** {
 206              		.loc 1 131 1 is_stmt 1 view -0
 207              		.cfi_startproc
 208              		@ args = 0, pretend = 0, frame = 0
 209              		@ frame_needed = 0, uses_anonymous_args = 0
 210              		@ link register save eliminated.
 132:Core/Src/boards/NucleoL476/spi-board.c ****     uint32_t divisor = 0;
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 7


 211              		.loc 1 132 5 view .LVU44
 133:Core/Src/boards/NucleoL476/spi-board.c ****     uint32_t sysClkTmp = SystemCoreClock;
 212              		.loc 1 133 5 view .LVU45
 213              		.loc 1 133 14 is_stmt 0 view .LVU46
 214 0000 0C4B     		ldr	r3, .L19
 215 0002 1A68     		ldr	r2, [r3]
 216              	.LVL14:
 134:Core/Src/boards/NucleoL476/spi-board.c ****     uint32_t baudRate;
 217              		.loc 1 134 5 is_stmt 1 view .LVU47
 135:Core/Src/boards/NucleoL476/spi-board.c **** 
 136:Core/Src/boards/NucleoL476/spi-board.c ****     while( sysClkTmp > hz )
 218              		.loc 1 136 5 view .LVU48
 132:Core/Src/boards/NucleoL476/spi-board.c ****     uint32_t sysClkTmp = SystemCoreClock;
 219              		.loc 1 132 14 is_stmt 0 view .LVU49
 220 0004 0023     		movs	r3, #0
 221              	.LVL15:
 222              	.L10:
 223              		.loc 1 136 10 is_stmt 1 view .LVU50
 224 0006 8A42     		cmp	r2, r1
 225 0008 03D9     		bls	.L11
 137:Core/Src/boards/NucleoL476/spi-board.c ****     {
 138:Core/Src/boards/NucleoL476/spi-board.c ****         divisor++;
 226              		.loc 1 138 9 view .LVU51
 227              		.loc 1 138 16 is_stmt 0 view .LVU52
 228 000a 0133     		adds	r3, r3, #1
 229              	.LVL16:
 139:Core/Src/boards/NucleoL476/spi-board.c ****         sysClkTmp = ( sysClkTmp >> 1 );
 230              		.loc 1 139 9 is_stmt 1 view .LVU53
 231              		.loc 1 139 19 is_stmt 0 view .LVU54
 232 000c 5208     		lsrs	r2, r2, #1
 233              	.LVL17:
 140:Core/Src/boards/NucleoL476/spi-board.c **** 
 141:Core/Src/boards/NucleoL476/spi-board.c ****         if( divisor >= 7 )
 234              		.loc 1 141 9 is_stmt 1 view .LVU55
 235              		.loc 1 141 11 is_stmt 0 view .LVU56
 236 000e 062B     		cmp	r3, #6
 237 0010 F9D9     		bls	.L10
 238              	.L11:
 142:Core/Src/boards/NucleoL476/spi-board.c ****         {
 143:Core/Src/boards/NucleoL476/spi-board.c ****             break;
 144:Core/Src/boards/NucleoL476/spi-board.c ****         }
 145:Core/Src/boards/NucleoL476/spi-board.c ****     }
 146:Core/Src/boards/NucleoL476/spi-board.c **** 
 147:Core/Src/boards/NucleoL476/spi-board.c ****     baudRate =( ( ( divisor & 0x4 ) == 0 ) ? 0x0 : SPI_CR1_BR_2 ) |
 239              		.loc 1 147 5 is_stmt 1 view .LVU57
 240              		.loc 1 147 50 is_stmt 0 view .LVU58
 241 0012 13F00402 		ands	r2, r3, #4
 242              	.LVL18:
 243              		.loc 1 147 50 view .LVU59
 244 0016 00D0     		beq	.L13
 245              		.loc 1 147 50 view .LVU60
 246 0018 2022     		movs	r2, #32
 247              	.L13:
 148:Core/Src/boards/NucleoL476/spi-board.c ****               ( ( ( divisor & 0x2 ) == 0 ) ? 0x0 : SPI_CR1_BR_1 ) |
 248              		.loc 1 148 50 view .LVU61
 249 001a 13F00201 		ands	r1, r3, #2
 250              	.LVL19:
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 8


 251              		.loc 1 148 50 view .LVU62
 252 001e 00D0     		beq	.L14
 253 0020 1021     		movs	r1, #16
 254              	.L14:
 147:Core/Src/boards/NucleoL476/spi-board.c ****               ( ( ( divisor & 0x2 ) == 0 ) ? 0x0 : SPI_CR1_BR_1 ) |
 255              		.loc 1 147 67 view .LVU63
 256 0022 0A43     		orrs	r2, r2, r1
 149:Core/Src/boards/NucleoL476/spi-board.c ****               ( ( ( divisor & 0x1 ) == 0 ) ? 0x0 : SPI_CR1_BR_0 );
 257              		.loc 1 149 50 view .LVU64
 258 0024 13F00103 		ands	r3, r3, #1
 259              	.LVL20:
 260              		.loc 1 149 50 view .LVU65
 261 0028 00D0     		beq	.L15
 262 002a 0823     		movs	r3, #8
 263              	.L15:
 147:Core/Src/boards/NucleoL476/spi-board.c ****               ( ( ( divisor & 0x2 ) == 0 ) ? 0x0 : SPI_CR1_BR_1 ) |
 264              		.loc 1 147 14 view .LVU66
 265 002c 1343     		orrs	r3, r3, r2
 266              	.LVL21:
 150:Core/Src/boards/NucleoL476/spi-board.c **** 
 151:Core/Src/boards/NucleoL476/spi-board.c ****     obj->Spi.Init.BaudRatePrescaler = baudRate;
 267              		.loc 1 151 5 is_stmt 1 view .LVU67
 268              		.loc 1 151 37 is_stmt 0 view .LVU68
 269 002e C361     		str	r3, [r0, #28]
 152:Core/Src/boards/NucleoL476/spi-board.c **** }
 270              		.loc 1 152 1 view .LVU69
 271 0030 7047     		bx	lr
 272              	.L20:
 273 0032 00BF     		.align	2
 274              	.L19:
 275 0034 00000000 		.word	SystemCoreClock
 276              		.cfi_endproc
 277              	.LFE138:
 279              		.section	.text.SpiInit,"ax",%progbits
 280              		.align	1
 281              		.global	SpiInit
 282              		.syntax unified
 283              		.thumb
 284              		.thumb_func
 285              		.fpu fpv4-sp-d16
 287              	SpiInit:
 288              	.LVL22:
 289              	.LFB135:
  33:Core/Src/boards/NucleoL476/spi-board.c ****     BoardDisableIrq( );
 290              		.loc 1 33 1 is_stmt 1 view -0
 291              		.cfi_startproc
 292              		@ args = 4, pretend = 0, frame = 8
 293              		@ frame_needed = 0, uses_anonymous_args = 0
  33:Core/Src/boards/NucleoL476/spi-board.c ****     BoardDisableIrq( );
 294              		.loc 1 33 1 is_stmt 0 view .LVU71
 295 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 296              	.LCFI6:
 297              		.cfi_def_cfa_offset 32
 298              		.cfi_offset 4, -32
 299              		.cfi_offset 5, -28
 300              		.cfi_offset 6, -24
 301              		.cfi_offset 7, -20
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 9


 302              		.cfi_offset 8, -16
 303              		.cfi_offset 9, -12
 304              		.cfi_offset 10, -8
 305              		.cfi_offset 14, -4
 306 0004 84B0     		sub	sp, sp, #16
 307              	.LCFI7:
 308              		.cfi_def_cfa_offset 48
 309 0006 0446     		mov	r4, r0
 310 0008 0D46     		mov	r5, r1
 311 000a 9146     		mov	r9, r2
 312 000c 9A46     		mov	r10, r3
 313 000e 9DF93080 		ldrsb	r8, [sp, #48]
  34:Core/Src/boards/NucleoL476/spi-board.c **** 
 314              		.loc 1 34 5 is_stmt 1 view .LVU72
 315 0012 FFF7FEFF 		bl	BoardDisableIrq
 316              	.LVL23:
  37:Core/Src/boards/NucleoL476/spi-board.c ****     {
 317              		.loc 1 37 5 view .LVU73
  37:Core/Src/boards/NucleoL476/spi-board.c ****     {
 318              		.loc 1 37 7 is_stmt 0 view .LVU74
 319 0016 152D     		cmp	r5, #21
 320 0018 0FD0     		beq	.L22
  37:Core/Src/boards/NucleoL476/spi-board.c ****     {
 321              		.loc 1 37 26 discriminator 1 view .LVU75
 322 001a 072D     		cmp	r5, #7
 323 001c 0DD0     		beq	.L22
  61:Core/Src/boards/NucleoL476/spi-board.c ****     {
 324              		.loc 1 61 10 is_stmt 1 view .LVU76
  61:Core/Src/boards/NucleoL476/spi-board.c ****     {
 325              		.loc 1 61 12 is_stmt 0 view .LVU77
 326 001e 1F2D     		cmp	r5, #31
 327 0020 5DD0     		beq	.L28
 328              	.LVL24:
 329              	.L25:
  85:Core/Src/boards/NucleoL476/spi-board.c **** 
 330              		.loc 1 85 5 is_stmt 1 view .LVU78
 331 0022 5849     		ldr	r1, .L31
 332 0024 2046     		mov	r0, r4
 333 0026 FFF7FEFF 		bl	SpiFrequency
 334              	.LVL25:
  87:Core/Src/boards/NucleoL476/spi-board.c **** 
 335              		.loc 1 87 5 view .LVU79
 336 002a 2046     		mov	r0, r4
 337 002c FFF7FEFF 		bl	HAL_SPI_Init
 338              	.LVL26:
  89:Core/Src/boards/NucleoL476/spi-board.c **** }
 339              		.loc 1 89 5 view .LVU80
 340 0030 FFF7FEFF 		bl	BoardEnableIrq
 341              	.LVL27:
  90:Core/Src/boards/NucleoL476/spi-board.c **** 
 342              		.loc 1 90 1 is_stmt 0 view .LVU81
 343 0034 04B0     		add	sp, sp, #16
 344              	.LCFI8:
 345              		.cfi_remember_state
 346              		.cfi_def_cfa_offset 32
 347              		@ sp needed
 348 0036 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 10


 349              	.LVL28:
 350              	.L22:
 351              	.LCFI9:
 352              		.cfi_restore_state
  39:Core/Src/boards/NucleoL476/spi-board.c ****         __HAL_RCC_SPI1_RELEASE_RESET( );
 353              		.loc 1 39 9 is_stmt 1 view .LVU82
 354 003a 5348     		ldr	r0, .L31+4
 355 003c 036C     		ldr	r3, [r0, #64]
 356 003e 43F48053 		orr	r3, r3, #4096
 357 0042 0364     		str	r3, [r0, #64]
 358              	.LVL29:
  40:Core/Src/boards/NucleoL476/spi-board.c **** 
 359              		.loc 1 40 9 view .LVU83
 360 0044 036C     		ldr	r3, [r0, #64]
 361 0046 23F48053 		bic	r3, r3, #4096
 362 004a 0364     		str	r3, [r0, #64]
  42:Core/Src/boards/NucleoL476/spi-board.c **** 
 363              		.loc 1 42 9 view .LVU84
 364              	.LBB2:
  42:Core/Src/boards/NucleoL476/spi-board.c **** 
 365              		.loc 1 42 9 view .LVU85
  42:Core/Src/boards/NucleoL476/spi-board.c **** 
 366              		.loc 1 42 9 view .LVU86
 367 004c 036E     		ldr	r3, [r0, #96]
 368 004e 43F48053 		orr	r3, r3, #4096
 369 0052 0366     		str	r3, [r0, #96]
  42:Core/Src/boards/NucleoL476/spi-board.c **** 
 370              		.loc 1 42 9 view .LVU87
 371 0054 036E     		ldr	r3, [r0, #96]
 372 0056 03F48053 		and	r3, r3, #4096
 373 005a 0293     		str	r3, [sp, #8]
  42:Core/Src/boards/NucleoL476/spi-board.c **** 
 374              		.loc 1 42 9 view .LVU88
 375 005c 029B     		ldr	r3, [sp, #8]
 376              	.LBE2:
  42:Core/Src/boards/NucleoL476/spi-board.c **** 
 377              		.loc 1 42 9 view .LVU89
  44:Core/Src/boards/NucleoL476/spi-board.c **** 
 378              		.loc 1 44 9 view .LVU90
  44:Core/Src/boards/NucleoL476/spi-board.c **** 
 379              		.loc 1 44 27 is_stmt 0 view .LVU91
 380 005e 2046     		mov	r0, r4
 381 0060 4A4B     		ldr	r3, .L31+8
 382 0062 40F8643B 		str	r3, [r0], #100
  46:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Miso, miso, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI1 
 383              		.loc 1 46 9 is_stmt 1 view .LVU92
 384 0066 0527     		movs	r7, #5
 385 0068 0197     		str	r7, [sp, #4]
 386 006a 0226     		movs	r6, #2
 387 006c 0096     		str	r6, [sp]
 388 006e 0023     		movs	r3, #0
 389 0070 3246     		mov	r2, r6
 390 0072 2946     		mov	r1, r5
 391 0074 FFF7FEFF 		bl	GpioInit
 392              	.LVL30:
  47:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Sclk, sclk, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI1 
 393              		.loc 1 47 9 view .LVU93
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 11


 394 0078 0197     		str	r7, [sp, #4]
 395 007a 0096     		str	r6, [sp]
 396 007c 0023     		movs	r3, #0
 397 007e 3246     		mov	r2, r6
 398 0080 4946     		mov	r1, r9
 399 0082 04F17000 		add	r0, r4, #112
 400 0086 FFF7FEFF 		bl	GpioInit
 401              	.LVL31:
  48:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Nss, nss, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_UP, GPIO_AF5_SPI1 );
 402              		.loc 1 48 9 view .LVU94
 403 008a 0197     		str	r7, [sp, #4]
 404 008c 0096     		str	r6, [sp]
 405 008e 0023     		movs	r3, #0
 406 0090 3246     		mov	r2, r6
 407 0092 5146     		mov	r1, r10
 408 0094 04F17C00 		add	r0, r4, #124
 409 0098 FFF7FEFF 		bl	GpioInit
 410              	.LVL32:
  49:Core/Src/boards/NucleoL476/spi-board.c **** 
 411              		.loc 1 49 9 view .LVU95
 412 009c 0197     		str	r7, [sp, #4]
 413 009e 0123     		movs	r3, #1
 414 00a0 0093     		str	r3, [sp]
 415 00a2 0023     		movs	r3, #0
 416 00a4 3246     		mov	r2, r6
 417 00a6 4146     		mov	r1, r8
 418 00a8 04F18800 		add	r0, r4, #136
 419 00ac FFF7FEFF 		bl	GpioInit
 420              	.LVL33:
  51:Core/Src/boards/NucleoL476/spi-board.c ****         {
 421              		.loc 1 51 9 view .LVU96
  51:Core/Src/boards/NucleoL476/spi-board.c ****         {
 422              		.loc 1 51 11 is_stmt 0 view .LVU97
 423 00b0 B8F1FF3F 		cmp	r8, #-1
 424 00b4 08D0     		beq	.L29
  58:Core/Src/boards/NucleoL476/spi-board.c ****         }
 425              		.loc 1 58 13 is_stmt 1 view .LVU98
 426 00b6 0123     		movs	r3, #1
 427 00b8 0093     		str	r3, [sp]
 428 00ba 0023     		movs	r3, #0
 429 00bc 1A46     		mov	r2, r3
 430 00be 1946     		mov	r1, r3
 431 00c0 2046     		mov	r0, r4
 432 00c2 FFF7FEFF 		bl	SpiFormat
 433              	.LVL34:
 434 00c6 ACE7     		b	.L25
 435              	.L29:
  53:Core/Src/boards/NucleoL476/spi-board.c ****             SpiFormat( obj, SPI_SIZE_8BIT, SPI_POLARITY_LOW, SPI_PHASE_1EDGE, 0 );
 436              		.loc 1 53 13 view .LVU99
  53:Core/Src/boards/NucleoL476/spi-board.c ****             SpiFormat( obj, SPI_SIZE_8BIT, SPI_POLARITY_LOW, SPI_PHASE_1EDGE, 0 );
 437              		.loc 1 53 31 is_stmt 0 view .LVU100
 438 00c8 4FF40073 		mov	r3, #512
 439 00cc A361     		str	r3, [r4, #24]
  54:Core/Src/boards/NucleoL476/spi-board.c ****         }
 440              		.loc 1 54 13 is_stmt 1 view .LVU101
 441 00ce 0021     		movs	r1, #0
 442 00d0 0091     		str	r1, [sp]
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 12


 443 00d2 0B46     		mov	r3, r1
 444 00d4 0A46     		mov	r2, r1
 445 00d6 2046     		mov	r0, r4
 446 00d8 FFF7FEFF 		bl	SpiFormat
 447              	.LVL35:
 448 00dc A1E7     		b	.L25
 449              	.LVL36:
 450              	.L28:
  63:Core/Src/boards/NucleoL476/spi-board.c ****         __HAL_RCC_SPI2_RELEASE_RESET( );
 451              		.loc 1 63 9 view .LVU102
 452 00de 2A4B     		ldr	r3, .L31+4
 453 00e0 9A6B     		ldr	r2, [r3, #56]
 454 00e2 42F48042 		orr	r2, r2, #16384
 455 00e6 9A63     		str	r2, [r3, #56]
 456              	.LVL37:
  64:Core/Src/boards/NucleoL476/spi-board.c **** 
 457              		.loc 1 64 9 view .LVU103
 458 00e8 9A6B     		ldr	r2, [r3, #56]
 459 00ea 22F48042 		bic	r2, r2, #16384
 460 00ee 9A63     		str	r2, [r3, #56]
  66:Core/Src/boards/NucleoL476/spi-board.c **** 
 461              		.loc 1 66 9 view .LVU104
 462              	.LBB3:
  66:Core/Src/boards/NucleoL476/spi-board.c **** 
 463              		.loc 1 66 9 view .LVU105
  66:Core/Src/boards/NucleoL476/spi-board.c **** 
 464              		.loc 1 66 9 view .LVU106
 465 00f0 9A6D     		ldr	r2, [r3, #88]
 466 00f2 42F48042 		orr	r2, r2, #16384
 467 00f6 9A65     		str	r2, [r3, #88]
  66:Core/Src/boards/NucleoL476/spi-board.c **** 
 468              		.loc 1 66 9 view .LVU107
 469 00f8 9B6D     		ldr	r3, [r3, #88]
 470 00fa 03F48043 		and	r3, r3, #16384
 471 00fe 0393     		str	r3, [sp, #12]
  66:Core/Src/boards/NucleoL476/spi-board.c **** 
 472              		.loc 1 66 9 view .LVU108
 473 0100 039B     		ldr	r3, [sp, #12]
 474              	.LBE3:
  66:Core/Src/boards/NucleoL476/spi-board.c **** 
 475              		.loc 1 66 9 view .LVU109
  68:Core/Src/boards/NucleoL476/spi-board.c **** 
 476              		.loc 1 68 9 view .LVU110
  68:Core/Src/boards/NucleoL476/spi-board.c **** 
 477              		.loc 1 68 27 is_stmt 0 view .LVU111
 478 0102 2046     		mov	r0, r4
 479 0104 224B     		ldr	r3, .L31+12
 480 0106 40F8643B 		str	r3, [r0], #100
  70:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Miso, miso, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI2 
 481              		.loc 1 70 9 is_stmt 1 view .LVU112
 482 010a 0527     		movs	r7, #5
 483 010c 0197     		str	r7, [sp, #4]
 484 010e 0226     		movs	r6, #2
 485 0110 0096     		str	r6, [sp]
 486 0112 0023     		movs	r3, #0
 487 0114 3246     		mov	r2, r6
 488 0116 2946     		mov	r1, r5
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 13


 489 0118 FFF7FEFF 		bl	GpioInit
 490              	.LVL38:
  71:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Sclk, sclk, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_DOWN, GPIO_AF5_SPI2 
 491              		.loc 1 71 9 view .LVU113
 492 011c 0197     		str	r7, [sp, #4]
 493 011e 0096     		str	r6, [sp]
 494 0120 0023     		movs	r3, #0
 495 0122 3246     		mov	r2, r6
 496 0124 4946     		mov	r1, r9
 497 0126 04F17000 		add	r0, r4, #112
 498 012a FFF7FEFF 		bl	GpioInit
 499              	.LVL39:
  72:Core/Src/boards/NucleoL476/spi-board.c ****         GpioInit( &obj->Nss, nss, PIN_ALTERNATE_FCT, PIN_PUSH_PULL, PIN_PULL_UP, GPIO_AF5_SPI2 );
 500              		.loc 1 72 9 view .LVU114
 501 012e 0197     		str	r7, [sp, #4]
 502 0130 0096     		str	r6, [sp]
 503 0132 0023     		movs	r3, #0
 504 0134 3246     		mov	r2, r6
 505 0136 5146     		mov	r1, r10
 506 0138 04F17C00 		add	r0, r4, #124
 507 013c FFF7FEFF 		bl	GpioInit
 508              	.LVL40:
  73:Core/Src/boards/NucleoL476/spi-board.c **** 
 509              		.loc 1 73 9 view .LVU115
 510 0140 0197     		str	r7, [sp, #4]
 511 0142 0123     		movs	r3, #1
 512 0144 0093     		str	r3, [sp]
 513 0146 0023     		movs	r3, #0
 514 0148 3246     		mov	r2, r6
 515 014a 4146     		mov	r1, r8
 516 014c 04F18800 		add	r0, r4, #136
 517 0150 FFF7FEFF 		bl	GpioInit
 518              	.LVL41:
  75:Core/Src/boards/NucleoL476/spi-board.c ****         {
 519              		.loc 1 75 9 view .LVU116
  75:Core/Src/boards/NucleoL476/spi-board.c ****         {
 520              		.loc 1 75 11 is_stmt 0 view .LVU117
 521 0154 B8F1FF3F 		cmp	r8, #-1
 522 0158 08D0     		beq	.L30
  82:Core/Src/boards/NucleoL476/spi-board.c ****         }
 523              		.loc 1 82 13 is_stmt 1 view .LVU118
 524 015a 0123     		movs	r3, #1
 525 015c 0093     		str	r3, [sp]
 526 015e 0023     		movs	r3, #0
 527 0160 1A46     		mov	r2, r3
 528 0162 1946     		mov	r1, r3
 529 0164 2046     		mov	r0, r4
 530 0166 FFF7FEFF 		bl	SpiFormat
 531              	.LVL42:
 532 016a 5AE7     		b	.L25
 533              	.L30:
  77:Core/Src/boards/NucleoL476/spi-board.c ****             SpiFormat( obj, SPI_SIZE_8BIT, SPI_POLARITY_LOW, SPI_PHASE_1EDGE, 0 );
 534              		.loc 1 77 13 view .LVU119
  77:Core/Src/boards/NucleoL476/spi-board.c ****             SpiFormat( obj, SPI_SIZE_8BIT, SPI_POLARITY_LOW, SPI_PHASE_1EDGE, 0 );
 535              		.loc 1 77 31 is_stmt 0 view .LVU120
 536 016c 4FF40073 		mov	r3, #512
 537 0170 A361     		str	r3, [r4, #24]
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 14


  78:Core/Src/boards/NucleoL476/spi-board.c ****         }
 538              		.loc 1 78 13 is_stmt 1 view .LVU121
 539 0172 0021     		movs	r1, #0
 540 0174 0091     		str	r1, [sp]
 541 0176 0B46     		mov	r3, r1
 542 0178 0A46     		mov	r2, r1
 543 017a 2046     		mov	r0, r4
 544 017c FFF7FEFF 		bl	SpiFormat
 545              	.LVL43:
 546 0180 4FE7     		b	.L25
 547              	.L32:
 548 0182 00BF     		.align	2
 549              	.L31:
 550 0184 0024F400 		.word	16000000
 551 0188 00100240 		.word	1073876992
 552 018c 00300140 		.word	1073819648
 553 0190 00380040 		.word	1073756160
 554              		.cfi_endproc
 555              	.LFE135:
 557              		.section	.rodata.SpiInOut.str1.4,"aMS",%progbits,1
 558              		.align	2
 559              	.LC0:
 560 0000 436F7265 		.ascii	"Core/Src/boards/NucleoL476/spi-board.c\000"
 560      2F537263 
 560      2F626F61 
 560      7264732F 
 560      4E75636C 
 561              		.section	.text.SpiInOut,"ax",%progbits
 562              		.align	1
 563              		.global	SpiInOut
 564              		.syntax unified
 565              		.thumb
 566              		.thumb_func
 567              		.fpu fpv4-sp-d16
 569              	SpiInOut:
 570              	.LVL44:
 571              	.LFB139:
 153:Core/Src/boards/NucleoL476/spi-board.c **** 
 154:Core/Src/boards/NucleoL476/spi-board.c **** uint16_t SpiInOut( Spi_t *obj, uint16_t outData )
 155:Core/Src/boards/NucleoL476/spi-board.c **** {
 572              		.loc 1 155 1 view -0
 573              		.cfi_startproc
 574              		@ args = 0, pretend = 0, frame = 16
 575              		@ frame_needed = 0, uses_anonymous_args = 0
 576              		.loc 1 155 1 is_stmt 0 view .LVU123
 577 0000 10B5     		push	{r4, lr}
 578              	.LCFI10:
 579              		.cfi_def_cfa_offset 8
 580              		.cfi_offset 4, -8
 581              		.cfi_offset 14, -4
 582 0002 86B0     		sub	sp, sp, #24
 583              	.LCFI11:
 584              		.cfi_def_cfa_offset 32
 585 0004 ADF80E10 		strh	r1, [sp, #14]	@ movhi
 156:Core/Src/boards/NucleoL476/spi-board.c ****     uint8_t rxData = 0;
 586              		.loc 1 156 5 is_stmt 1 view .LVU124
 587              		.loc 1 156 13 is_stmt 0 view .LVU125
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 15


 588 0008 0023     		movs	r3, #0
 589 000a 8DF81730 		strb	r3, [sp, #23]
 157:Core/Src/boards/NucleoL476/spi-board.c **** 
 158:Core/Src/boards/NucleoL476/spi-board.c ****     if( ( obj == NULL ) || ( obj->Spi.Instance ) == NULL )
 590              		.loc 1 158 5 is_stmt 1 view .LVU126
 591              		.loc 1 158 7 is_stmt 0 view .LVU127
 592 000e 0446     		mov	r4, r0
 593 0010 C8B1     		cbz	r0, .L34
 594              		.loc 1 158 38 discriminator 1 view .LVU128
 595 0012 0368     		ldr	r3, [r0]
 596              		.loc 1 158 25 discriminator 1 view .LVU129
 597 0014 BBB1     		cbz	r3, .L34
 598              	.LVL45:
 599              	.L35:
 159:Core/Src/boards/NucleoL476/spi-board.c ****     {
 160:Core/Src/boards/NucleoL476/spi-board.c ****         assert_param( FAIL );
 161:Core/Src/boards/NucleoL476/spi-board.c ****     }
 162:Core/Src/boards/NucleoL476/spi-board.c **** 
 163:Core/Src/boards/NucleoL476/spi-board.c ****     __HAL_SPI_ENABLE( &obj->Spi );
 600              		.loc 1 163 5 is_stmt 1 view .LVU130
 601 0016 2268     		ldr	r2, [r4]
 602 0018 1368     		ldr	r3, [r2]
 603 001a 43F04003 		orr	r3, r3, #64
 604 001e 1360     		str	r3, [r2]
 164:Core/Src/boards/NucleoL476/spi-board.c **** 
 165:Core/Src/boards/NucleoL476/spi-board.c ****     BoardDisableIrq( );
 605              		.loc 1 165 5 view .LVU131
 606 0020 FFF7FEFF 		bl	BoardDisableIrq
 607              	.LVL46:
 166:Core/Src/boards/NucleoL476/spi-board.c **** 
 167:Core/Src/boards/NucleoL476/spi-board.c ****     HAL_SPI_TransmitReceive( &obj->Spi, ( uint8_t * ) &outData, ( uint8_t* ) &rxData, 1, 0xFFFF);
 608              		.loc 1 167 5 view .LVU132
 609 0024 4FF6FF73 		movw	r3, #65535
 610 0028 0093     		str	r3, [sp]
 611 002a 0123     		movs	r3, #1
 612 002c 0DF11702 		add	r2, sp, #23
 613 0030 0DF10E01 		add	r1, sp, #14
 614 0034 2046     		mov	r0, r4
 615 0036 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
 616              	.LVL47:
 168:Core/Src/boards/NucleoL476/spi-board.c **** 
 169:Core/Src/boards/NucleoL476/spi-board.c ****     BoardEnableIrq( );
 617              		.loc 1 169 5 view .LVU133
 618 003a FFF7FEFF 		bl	BoardEnableIrq
 619              	.LVL48:
 170:Core/Src/boards/NucleoL476/spi-board.c **** 
 171:Core/Src/boards/NucleoL476/spi-board.c ****     return( rxData );
 620              		.loc 1 171 5 view .LVU134
 172:Core/Src/boards/NucleoL476/spi-board.c **** }
 621              		.loc 1 172 1 is_stmt 0 view .LVU135
 622 003e 9DF81700 		ldrb	r0, [sp, #23]	@ zero_extendqisi2
 623 0042 06B0     		add	sp, sp, #24
 624              	.LCFI12:
 625              		.cfi_remember_state
 626              		.cfi_def_cfa_offset 8
 627              		@ sp needed
 628 0044 10BD     		pop	{r4, pc}
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 16


 629              	.LVL49:
 630              	.L34:
 631              	.LCFI13:
 632              		.cfi_restore_state
 160:Core/Src/boards/NucleoL476/spi-board.c ****     }
 633              		.loc 1 160 9 is_stmt 1 view .LVU136
 634 0046 A021     		movs	r1, #160
 635              	.LVL50:
 160:Core/Src/boards/NucleoL476/spi-board.c ****     }
 636              		.loc 1 160 9 is_stmt 0 view .LVU137
 637 0048 0148     		ldr	r0, .L37
 638              	.LVL51:
 160:Core/Src/boards/NucleoL476/spi-board.c ****     }
 639              		.loc 1 160 9 view .LVU138
 640 004a FFF7FEFF 		bl	assert_failed
 641              	.LVL52:
 160:Core/Src/boards/NucleoL476/spi-board.c ****     }
 642              		.loc 1 160 9 view .LVU139
 643 004e E2E7     		b	.L35
 644              	.L38:
 645              		.align	2
 646              	.L37:
 647 0050 00000000 		.word	.LC0
 648              		.cfi_endproc
 649              	.LFE139:
 651              		.text
 652              	.Letext0:
 653              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2020-q4-major\\arm-none-eabi\\inc
 654              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2020-q4-major\\arm-none-eabi\\inc
 655              		.file 4 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/stm32l476xx.h"
 656              		.file 5 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_def.h"
 657              		.file 6 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_dma.h"
 658              		.file 7 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_spi.h"
 659              		.file 8 "Core/Src/system/gpio.h"
 660              		.file 9 "Core/Src/boards/NucleoL476/spi-board.h"
 661              		.file 10 "Core/Src/system/spi.h"
 662              		.file 11 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/system_stm32l4xx.h"
 663              		.file 12 "Core/Src/boards/NucleoL476/board.h"
 664              		.file 13 "Core/Inc/stm32l4xx_hal_conf.h"
ARM GAS  C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s 			page 17


DEFINED SYMBOLS
                            *ABS*:00000000 spi-board.c
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:18     .text.SpiDeInit:00000000 $t
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:26     .text.SpiDeInit:00000000 SpiDeInit
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:97     .text.SpiFormat:00000000 $t
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:104    .text.SpiFormat:00000000 SpiFormat
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:196    .text.SpiFrequency:00000000 $t
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:203    .text.SpiFrequency:00000000 SpiFrequency
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:275    .text.SpiFrequency:00000034 $d
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:280    .text.SpiInit:00000000 $t
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:287    .text.SpiInit:00000000 SpiInit
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:550    .text.SpiInit:00000184 $d
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:558    .rodata.SpiInOut.str1.4:00000000 $d
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:562    .text.SpiInOut:00000000 $t
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:569    .text.SpiInOut:00000000 SpiInOut
C:\Users\andywei\AppData\Local\Temp\ccaTYvTw.s:647    .text.SpiInOut:00000050 $d

UNDEFINED SYMBOLS
HAL_SPI_DeInit
GpioInit
SystemCoreClock
BoardDisableIrq
HAL_SPI_Init
BoardEnableIrq
HAL_SPI_TransmitReceive
assert_failed
